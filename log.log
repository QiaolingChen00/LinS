WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
distributed framework torch initialized

---- Performance of all_to_all on 512 devices ---------------------------------------------------------
Size (Bytes)         Description               Duration             Throughput (Gbps)    BusBW (Gbps)        
----------------------------------------------------------------------------------------------------
4.0 KB               1024x4                    3.673 ms             0.009                0.009               
8.0 KB               2048x4                    2.447 ms             0.027                0.027               
16.0 KB              4096x4                    2.403 ms             0.055                0.054               
32.0 KB              8192x4                    2.425 ms             0.108                0.108               
64.0 KB              16384x4                   2.369 ms             0.221                0.221               
128.0 KB             32768x4                   2.495 ms             0.420                0.420               
256.0 KB             65536x4                   2.538 ms             0.826                0.825               
512.0 KB             131072x4                  2.710 ms             1.548                1.545               
1.0 MB               262144x4                  2.530 ms             3.315                3.309               
2.0 MB               524288x4                  2.361 ms             7.107                7.093               
4.0 MB               1048576x4                 2.600 ms             12.906               12.880              
8.0 MB               2097152x4                 2.501 ms             26.836               26.783              
16.0 MB              4194304x4                 13.584 ms            9.880                9.861               
32.0 MB              8388608x4                 29.533 ms            9.089                9.072               
64.0 MB              16777216x4                34.928 ms            15.371               15.341              
128.0 MB             33554432x4                32.373 ms            33.168               33.103              
256.0 MB             67108864x4                59.587 ms            36.039               35.969              
512.0 MB             134217728x4               70.583 ms            60.850               60.731              
1.0 GB               268435456x4               134.189 ms           64.014               63.889              
2.0 GB               536870912x4               233.549 ms           73.560               73.417              
4.0 GB               1073741824x4              441.103 ms           77.895               77.743              

WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
distributed framework torch initialized

---- Performance of all_to_all on 64 devices ---------------------------------------------------------
Size (Bytes)         Description               Duration             Throughput (Gbps)    BusBW (Gbps)        
----------------------------------------------------------------------------------------------------
512.0 B              128x4                     581.872 us           0.007                0.007               
1.0 KB               256x4                     412.427 us           0.020                0.020               
2.0 KB               512x4                     421.643 us           0.039                0.038               
4.0 KB               1024x4                    598.287 us           0.055                0.054               
8.0 KB               2048x4                    389.809 us           0.168                0.165               
16.0 KB              4096x4                    405.855 us           0.323                0.318               
32.0 KB              8192x4                    376.832 us           0.696                0.685               
64.0 KB              16384x4                   385.875 us           1.359                1.337               
128.0 KB             32768x4                   373.458 us           2.808                2.764               
256.0 KB             65536x4                   381.388 us           5.499                5.413               
512.0 KB             131072x4                  362.009 us           11.586               11.405              
1.0 MB               262144x4                  384.377 us           21.824               21.483              
2.0 MB               524288x4                  10.292 ms            1.630                1.605               
4.0 MB               1048576x4                 4.733 ms             7.090                6.979               
8.0 MB               2097152x4                 1.051 ms             63.862               62.864              
16.0 MB              4194304x4                 1.886 ms             71.168               70.056              
32.0 MB              8388608x4                 3.385 ms             79.301               78.062              
64.0 MB              16777216x4                6.278 ms             85.523               84.187              
128.0 MB             33554432x4                12.597 ms            85.237               83.905              
256.0 MB             67108864x4                24.056 ms            89.269               87.874              
512.0 MB             134217728x4               47.342 ms            90.723               89.305              
